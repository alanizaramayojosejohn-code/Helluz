<!-- components/form/container/component.html -->
<div class="min-h-screen bg-white text-white p-6">
  <div class="max-w-3xl mx-auto">
    <div class="mb-8">
      <h1 class="text-4xl font-bold text-red-600 mb-2">
        {{ getFormTitle() }}
      </h1>
      <p class="text-gray-400">Completa la informaciÃ³n del usuario</p>
    </div>

    @if (!isEditMode()) {
      <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
        <div class="flex items-start gap-3">
          <svg class="w-5 h-5 text-yellow-600 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
          </svg>
          <div>
            <p class="font-semibold text-yellow-900 mb-2">Pasos previos requeridos:</p>
            <ol class="text-sm text-yellow-800 space-y-2 list-decimal list-inside">
              <li><strong>Ir a Firebase Console:</strong> Authentication â†’ Users</li>
              <li><strong>Hacer clic en "Add User"</strong></li>
              <li><strong>Ingresar email y contraseÃ±a</strong> del nuevo usuario</li>
              <li><strong>Copiar el UID</strong> que aparece en la lista de usuarios</li>
              <li><strong>Pegar el UID</strong> en el campo de abajo y completar los datos</li>
            </ol>
            <p class="text-xs text-yellow-700 mt-2">
              ðŸ’¡ El UID es un identificador Ãºnico como: <code class="bg-yellow-100 px-1 rounded">abc123xyz456...</code>
            </p>
          </div>
        </div>
      </div>
    }

    @if (isLoading()) {
      <div class="flex justify-center p-8">
        <mat-spinner diameter="50"></mat-spinner>
      </div>
    }

    @if (errorMessage()) {
      <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-4">
        {{ errorMessage() }}
      </div>
    }

    <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="space-y-6">
      <div class="bg-white shadow-sm shadow-black border border-gray-800 rounded-lg p-6 space-y-6">

        @if (!isEditMode()) {
          <!-- UID (solo en modo creaciÃ³n) -->
          <div class="border-b border-gray-200 pb-4">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Datos de Firebase Authentication</h2>

            <mat-form-field appearance="outline" class="w-full">
              <mat-label>UID de Firebase Authentication</mat-label>
              <input matInput formControlName="uid" placeholder="Pega aquÃ­ el UID copiado de Firebase Console" />
              <mat-hint>Copia el UID desde Firebase Console â†’ Authentication â†’ Users</mat-hint>
              @if (hasError('uid')) {
                <mat-error>{{ getErrorMessage('uid') }}</mat-error>
              }
            </mat-form-field>

            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Email</mat-label>
              <input matInput type="email" formControlName="email" placeholder="Debe coincidir con el email en Firebase Auth" />
              <mat-hint>Debe ser el mismo email usado en Firebase Authentication</mat-hint>
              @if (hasError('email')) {
                <mat-error>{{ getErrorMessage('email') }}</mat-error>
              }
            </mat-form-field>
          </div>
        }

        <!-- Datos Personales -->
        <div class="border-b border-gray-200 pb-4">
          <h2 class="text-xl font-semibold text-gray-800 mb-4">Datos Personales</h2>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <!-- Nombre -->
            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Nombre</mat-label>
              <input matInput formControlName="name" placeholder="Ingrese el nombre" />
              @if (hasError('name')) {
                <mat-error>{{ getErrorMessage('name') }}</mat-error>
              }
            </mat-form-field>

            <!-- Apellido -->
            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Apellido</mat-label>
              <input matInput formControlName="lastname" placeholder="Ingrese el apellido" />
              @if (hasError('lastname')) {
                <mat-error>{{ getErrorMessage('lastname') }}</mat-error>
              }
            </mat-form-field>
          </div>
        </div>

        <!-- Rol y Estado -->
        <div>
          <h2 class="text-xl font-semibold text-gray-800 mb-4">ConfiguraciÃ³n del Sistema</h2>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <!-- Rol -->
            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Rol</mat-label>
              <mat-select formControlName="role">
                <mat-option value="admin">Administrador</mat-option>
                <mat-option value="instructor">Instructor</mat-option>
              </mat-select>
              @if (hasError('role')) {
                <mat-error>{{ getErrorMessage('role') }}</mat-error>
              }
            </mat-form-field>

            <!-- Estado -->
            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Estado</mat-label>
              <mat-select formControlName="status">
                <mat-option value="activo">Activo</mat-option>
                <mat-option value="inactivo">Inactivo</mat-option>
              </mat-select>
              @if (hasError('status')) {
                <mat-error>{{ getErrorMessage('status') }}</mat-error>
              }
            </mat-form-field>
          </div>
        </div>
      </div>

      <!-- Botones -->
      <div class="flex gap-4 justify-end">
        <button
          type="button"
          class="px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition font-semibold disabled:opacity-50"
          (click)="onCancel()"
          [disabled]="isSubmitting()"
        >
          Cancelar
        </button>
        <button
          type="submit"
          class="px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition font-semibold disabled:opacity-50 flex items-center gap-2"
          [disabled]="isSubmitting()"
        >
          @if (isSubmitting()) {
            <mat-spinner diameter="20" class="inline-block"></mat-spinner>
          }
          {{ isEditMode() ? 'Actualizar' : 'Registrar' }}
        </button>
      </div>
    </form>
  </div>
</div>
